<!DOCTYPE html>
<html>
<head>
    <script src="phaser.min.js"></script>
</head>
<body>

	<h2>Running out of space</h2>
    <script>
    var config = {
        type: Phaser.AUTO,
        width: 800,
        height: 600,
        physics: {
            default: 'arcade',
            arcade: {
                gravity: { y: 0 }
            }
        },
        scene: {
            preload: preload,
            create: create
        }
    };

    var game = new Phaser.Game(config);

    function preload ()
    {
		this.load.image('image_tiles', 'tiles.png');
        //this.load.setBaseURL('http://labs.phaser.io');

        //this.load.image('sky', 'assets/skies/space3.png');
        //this.load.image('logo', 'assets/sprites/phaser3-logo.png');
        //this.load.image('red', 'assets/particles/red.png');
    }

    function create ()
    {
		var map = this.make.tilemap({
			//key: 'map',
			tileWidth: 16,
			tileHeight: 16,
			width: 100,
			height: 100
		});

		var tileset = map.addTilesetImage('tileset_tiles', 'image_tiles', 16, 16);

		var testLayer = map.createBlankDynamicLayer('main_layer', tileset);

		var indexes = {
			TOPL: 0,
			TOPC: 1,
			TOPR: 2,
			LEFT: 4,
			FLOOR: 5,
			RIGHT: 6,
			BOTL:  8,
			BOTC: 9,
			BOTR: 10
		};

		for (var i = 0; i < 8; ++i)
		{
			var rw = Phaser.Math.RND.between(3,5) * 2;
			var rh = Phaser.Math.RND.between(3,5) * 2;
			var rx = Phaser.Math.RND.between(0, 40 - rw);
			var ry = Phaser.Math.RND.between(0, 40 - rh);

			// corners
			testLayer.putTileAt(indexes.TOPL, rx,          ry);
			testLayer.putTileAt(indexes.TOPR, rx + rw - 1, ry);
			testLayer.putTileAt(indexes.BOTL, rx,          ry + rh - 1);
			testLayer.putTileAt(indexes.BOTR, rx + rw - 1, ry + rh - 1);

			// sides
			testLayer.fill(indexes.TOPC,  rx+1,             ry, rw-2,    1);
			testLayer.fill(indexes.LEFT,  rx,             ry+1,    1, rh-2);
			testLayer.fill(indexes.RIGHT, rx+rw-1,        ry+1,    1, rh-2);
			testLayer.fill(indexes.BOTC,  rx+1,    ry + rh - 1, rw-2,    1);

			// gooey center
			testLayer.fill(indexes.FLOOR, rx+1, ry+1, rw-2, rh-2);
		}

		//this.add.image(32, 32, 'image_tiles');

		//this.add.image(132, 232, 'image_tiles');
        //this.add.image(400, 300, 'sky');

        //var particles = this.add.particles('red');

        //var emitter = particles.createEmitter({
        //    speed: 100,
        //    scale: { start: 1, end: 0 },
        //    blendMode: 'ADD'
        //});

        //var logo = this.physics.add.image(400, 100, 'logo');

        //logo.setVelocity(100, 200);
        //logo.setBounce(1, 1);
        //logo.setCollideWorldBounds(true);

        //emitter.startFollow(logo);
    }
    </script>

</body>
</html>
